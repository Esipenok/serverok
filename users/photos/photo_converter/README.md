# Конвертер изображений для WebP

Модуль для конвертации и оптимизации изображений в формат WebP. Поддерживает конвертацию из форматов JPEG, PNG, GIF, HEIC и HEIF.

## Возможности

- Конвертация изображений в формат WebP с оптимизацией
- Создание миниатюр для профилей пользователей
- Оптимизация изображений для различных целей (профиль, галерея, чат)
- Поддержка специальных форматов HEIC/HEIF
- Автоматическое удаление исходных файлов после конвертации

## Преимущества WebP

- На 25-35% меньший размер файла по сравнению с JPEG при том же визуальном качестве
- Поддержка прозрачности (как в PNG) с меньшим размером файла
- Поддержка анимации (как в GIF) с лучшим сжатием
- Быстрая загрузка на мобильных устройствах
- Экономия трафика пользователей

## Использование

### Конвертация изображения

```javascript
const photoConverter = require('./photo_converter');

// Конвертация изображения для галереи
const webpPath = await photoConverter.optimizeImage('/path/to/image.jpg', 'user123', 'gallery');
console.log('Путь к конвертированному изображению:', webpPath);
```

### Создание миниатюры

```javascript
// Создание миниатюры для профиля
const thumbnailPath = await photoConverter.createThumbnail('/path/to/image.jpg', 'user123');
console.log('Путь к миниатюре:', thumbnailPath);
```

### Обработка загруженных файлов

```javascript
// Обработка массива загруженных файлов
const processedFiles = await photoConverter.processUploadedFiles(files, 'user123', 'profile');
console.log('Обработанные файлы:', processedFiles);
```

### Получение информации об изображении

```javascript
// Получение информации о размере и формате изображения
const imageInfo = await photoConverter.getImageInfo('/path/to/image.webp');
console.log('Информация об изображении:', imageInfo);
```

## Настройка

Настройки конвертера находятся в файле `config.js`. Вы можете изменить параметры для разных типов изображений:

```javascript
// Настройки для разных типов изображений
imageTypes: {
  profile: {
    width: 800,       // Оптимальная ширина для фото профиля
    quality: 85,      // Высокое качество для профиля
    effort: 5         // Уровень сжатия (0-6)
  },
  // ... другие настройки
}
```

## Тестирование

Для тестирования конвертера используйте скрипт `test.js`:

```bash
node test.js path/to/your/image.jpg
```

## Зависимости

- sharp: Библиотека для обработки изображений
- webp-converter: Библиотека для конвертации в WebP (особенно для HEIC/HEIF форматов)
- fs: Работа с файловой системой
- path: Работа с путями 